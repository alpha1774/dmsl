21)â€“22) Employee/Works/Company/Manages (two SQL sets)


-- Set 1
SELECT employee_name FROM Works WHERE company_name='First Bank Coorporation';
SELECT w.employee_name, e.city FROM Works w JOIN Employee e ON e.employee_name=w.employee_name
WHERE w.company_name='First Bank Coorporation';
SELECT e.employee_name, e.street, e.city
FROM Employee e JOIN Works w ON w.employee_name=e.employee_name
WHERE w.company_name='First Bank Coorporation' AND w.salary>10000;
SELECT e.employee_name FROM Employee e
JOIN Works w ON w.employee_name=e.employee_name
JOIN Company c ON c.company_name=w.company_name
WHERE e.city=c.city;
SELECT e.employee_name FROM Employee e JOIN Manages m ON m.employee_name=e.employee_name
JOIN Employee mgr ON mgr.employee_name=m.manager_name
WHERE e.city=mgr.city AND e.street=mgr.street;
SELECT e.employee_name FROM Employee e
WHERE NOT EXISTS (SELECT 1 FROM Works w WHERE w.employee_name=e.employee_name
  AND w.company_name='First Bank Coorporation');
UPDATE Works SET salary=salary*1.10 WHERE company_name='First Bank Coorporation';
DELETE FROM Works WHERE company_name='Small Bank Coorporation';

-- Set 2
SELECT DISTINCT w1.employee_name
FROM Works w1 WHERE w1.salary > ALL (SELECT salary FROM Works WHERE company_name='Small Bank Coorporation');

SELECT c.company_name FROM Company c
WHERE NOT EXISTS (
  SELECT city FROM Company WHERE company_name='Small Bank Coorporation'
  MINUS
  SELECT city FROM Company WHERE company_name=c.company_name
);

SELECT w.employee_name
FROM Works w JOIN (SELECT company_name, AVG(salary) a FROM Works GROUP BY company_name) x
ON x.company_name=w.company_name WHERE w.salary > x.a;

SELECT company_name FROM Works GROUP BY company_name ORDER BY COUNT(*) DESC FETCH FIRST 1 ROW ONLY;
SELECT company_name FROM Works GROUP BY company_name ORDER BY SUM(salary)  ASC FETCH FIRST 1 ROW ONLY;

SELECT company_name FROM Works GROUP BY company_name
HAVING AVG(salary) > (SELECT AVG(salary) FROM Works WHERE company_name='First Bank Coorporation');

UPDATE Employee SET city='Newtown' WHERE employee_name='Jones';
